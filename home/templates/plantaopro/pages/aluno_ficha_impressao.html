{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Requerimento de Matr√≠cula ‚Äî {{ aluno.nome }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    /* ======= A4 e fontes ======= */
    @page { size: A4; margin: 15mm 15mm 18mm 15mm; }
    html, body { background:#fff; }
    body {
      font-family: "Times New Roman", Georgia, "DejaVu Serif", serif;
      color:#000; font-size: 12pt; line-height: 1.25;
      margin:0; padding:0;
    }

    .only-screen { display:flex; gap:.5rem; align-items:center; margin:12px 0; }
    @media print { .only-screen { display:none !important; } a[href]:after { content: ""; } }

    /* ======= Marca d'√°gua ======= */
    .watermark {
      position: fixed; top: 25%; left: 50%;
      transform: translate(-50%, -25%); width: 70%;
      opacity: 0.08; z-index: -1;
    }

    /* ======= Cabe√ßalho ======= */
    .header {
      display: grid; grid-template-columns: 1fr 110px;
      column-gap: 12px; align-items: center; margin-bottom: 8px;
    }
    .school-name {
      font-size: 14pt; font-weight: bold; text-transform: uppercase; text-align: center;
    }
    .school-sub { font-size: 10pt; text-align: center; margin-top: 2px; }
    .foto-box {
      border:1px solid #000; width: 110px; height: 135px;
      display:flex; align-items:center; justify-content:center; font-size: 10pt;
    }
    .line { border-top:1px solid #000; margin:6px 0 10px; }

    /* ======= Blocos ======= */
    .box { border: 1px solid #000; padding: 6px 8px; margin-top: 8px; }
    .box-title { font-weight: bold; text-transform: uppercase; margin-bottom: 4px; font-size: 11pt; }

    /* Linhas preench√≠veis */
    .fieldline {
      border-bottom: 1px solid #000; display: inline-block; min-width: 120px; padding: 0 2px 1px 2px;
    }
    .label { margin-right: 6px; }

    /* Tabela simples */
    table.sheet { width: 100%; border-collapse: collapse; }
    table.sheet td { padding: 3px 4px; vertical-align: top; }
    .w-30 { width:30%; } .w-40 { width:40%; } .w-50 { width:50%; } .w-60 { width:60%; }
    .center { text-align:center; }

    /* ‚Äúcheckbox‚Äù estilo papel: s√≥ o X dentro de par√™nteses */
    .opt { margin-right: 14px; white-space: nowrap; }
    .cb { display:inline; font-weight:bold; }

    /* Assinaturas */
    .signrow { display:flex; justify-content: space-between; margin-top: 40px; }
    .sign { text-align: center; width: 45%; }
    .sign .line { border-top:1px solid #000; margin: 40px 0 4px; }

    /* Se√ß√£o superior (requerimento) */
    .req-text { margin: 6px 0 10px; }
  </style>
</head>
<body>

  <!-- Marca d'√°gua -->
  <img src="{% static 'plantaopro/images/marcadagua.png' %}" alt="" class="watermark">

  <!-- A√ß√µes (s√≥ na tela) -->
  <div class="only-screen">
    <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
    <a href="javascript:history.back()">‚Üê Voltar</a>
  </div>

  <!-- Cabe√ßalho -->
  <div class="header">
    <div>
      <div class="school-name">
        {{ aluno.escola.nome|default:"ESCOLA PEQUENO APRENDIZ" }}
      </div>
      <div class="school-sub">
        {% if aluno.escola %}
          {{ aluno.escola.endereco }}{% if aluno.escola.numero %}, {{ aluno.escola.numero }}{% endif %}
          ‚Äî {{ aluno.escola.bairro }} ‚Äî {{ aluno.escola.cidade }}/{{ aluno.escola.estado }}<br>
          CNPJ: {{ aluno.escola.cnpj|default:"00.000.000/0000-00" }} ‚Ä¢
          E-mail: {{ aluno.escola.email|default:"escola@email.com" }}
        {% else %}
          Endere√ßo: ________ ‚Ä¢ CNPJ: ________ ‚Ä¢ E-mail: ________
        {% endif %}
      </div>
    </div>
    <div class="foto-box">Foto 3x4</div>
  </div>

  <div class="line"></div>

  <!-- T√≠tulo -->
  <div class="center" style="font-weight:bold; text-transform:uppercase;">REQUERIMENTO DE MATR√çCULA</div>

  <!-- Texto do requerimento -->
  <div class="req-text">
    Requeiro a matr√≠cula do(a) aluno(a)
    <span class="fieldline" style="min-width:280px">{{ aluno.nome }}</span>
    no Ensino:
    <span class="fieldline" style="min-width:140px">Fundamental</span>,
    S√©rie/Ano:
    <span class="fieldline" style="min-width:120px">
      {{ aluno.serie_ano|default_if_none:"" }}
    </span>,
    Turno:
    <span class="fieldline" style="min-width:90px">
      {{ aluno.turno_aluno|default_if_none:"" }}
    </span>,
    declarando estar ciente das disposi√ß√µes que constam no regimento interno deste estabelecimento e responsabilizando-me pela autenticidade dos documentos entregues neste ato.
  </div>

  <!-- Bloco: Dados do aluno -->
  <div class="box">
    <div class="box-title">Dados cadastrais do(a) aluno(a)</div>
    <table class="sheet">
      <tr>
        <td class="w-60">
          <span class="label">Nome completo:</span>
          <span class="fieldline" style="min-width:280px">{{ aluno.nome }}</span>
        </td>
        <td class="w-40">
          <span class="label">Fator RH:</span>
          <span class="fieldline" style="min-width:120px">{{ aluno.tipo_sanguineo|default:"" }}</span>
        </td>
      </tr>
      <tr>
        <td><span class="label">CPF:</span> <span class="fieldline" style="min-width:160px">{{ aluno.cpf|default:"" }}</span></td>
        <td><span class="label">RG:</span> <span class="fieldline" style="min-width:160px">{{ aluno.rg|default:"" }}</span></td>
      </tr>
      <tr>
        <td><span class="label">Data de nasc.:</span> <span class="fieldline" style="min-width:140px">{{ aluno.data_nascimento|date:"d/m/Y" }}</span></td>
        <td><span class="label">Naturalidade:</span> <span class="fieldline" style="min-width:180px">{{ aluno.naturalidade|default:"" }}</span></td>
      </tr>
      <tr>
        <td colspan="2">
          <span class="label">Endere√ßo:</span>
          <span class="fieldline" style="min-width:360px">
            {{ aluno.rua }}{% if aluno.numero %}, {{ aluno.numero }}{% endif %} ‚Äî {{ aluno.bairro }} ‚Äî {{ aluno.cidade }}/{{ aluno.estado }}{% if aluno.cep %} ‚Ä¢ CEP: {{ aluno.cep }}{% endif %}
          </span>
        </td>
      </tr>
      <tr>
        <td><span class="label">E-mail:</span> <span class="fieldline" style="min-width:260px">{{ aluno.email|default:"" }}</span></td>
        <td><span class="label">Telefone:</span> <span class="fieldline" style="min-width:160px">{{ aluno.telefone|default:"" }}</span></td>
      </tr>
      <tr>
        <td><span class="label">Matr√≠cula:</span> <span class="fieldline" style="min-width:180px">{{ aluno.matricula }}</span></td>
        <td><span class="label">Turma/Turno:</span>
          <span class="fieldline" style="min-width:180px">
            {% if aluno.turmas.all %}
              {% for t in aluno.turmas.all %}{{ t.nome }} ({{ t.turno }}){% if not forloop.last %} ‚Ä¢ {% endif %}{% endfor %}
            {% endif %}
          </span>
        </td>
      </tr>
    </table>
  </div>

  <!-- Dados do pai -->
  <div class="box">
    <div class="box-title">Dados cadastrais do pai</div>
    <table class="sheet">
      <tr>
        <td class="w-60"><span class="label">Nome completo:</span> <span class="fieldline" style="min-width:300px">{{ dados_pai.nome }}</span></td>
        <td class="w-40"><span class="label">Identidade:</span> <span class="fieldline" style="min-width:140px">{{ dados_pai.identidade }}</span></td>
      </tr>
      <tr>
        <td><span class="label">CPF:</span> <span class="fieldline" style="min-width:160px">{{ dados_pai.cpf }}</span></td>
        <td><span class="label">Escolaridade:</span> <span class="fieldline" style="min-width:160px">{{ dados_pai.escolaridade }}</span></td>
      </tr>
      <tr>
        <td><span class="label">Fone:</span> <span class="fieldline" style="min-width:200px">{{ dados_pai.telefone }}</span></td>
        <td><span class="label">E-mail:</span> <span class="fieldline" style="min-width:200px">{{ dados_pai.email }}</span></td>
      </tr>
    </table>
  </div>

  <!-- Dados da m√£e -->
  <div class="box">
    <div class="box-title">Dados cadastrais da m√£e</div>
    <table class="sheet">
      <tr>
        <td class="w-60"><span class="label">Nome completo:</span> <span class="fieldline" style="min-width:300px">{{ dados_mae.nome }}</span></td>
        <td class="w-40"><span class="label">Identidade:</span> <span class="fieldline" style="min-width:140px">{{ dados_mae.identidade }}</span></td>
      </tr>
      <tr>
        <td><span class="label">CPF:</span> <span class="fieldline" style="min-width:160px">{{ dados_mae.cpf }}</span></td>
        <td><span class="label">Escolaridade:</span> <span class="fieldline" style="min-width:160px">{{ dados_mae.escolaridade }}</span></td>
      </tr>
      <tr>
        <td><span class="label">Fone:</span> <span class="fieldline" style="min-width:200px">{{ dados_mae.telefone }}</span></td>
        <td><span class="label">E-mail:</span> <span class="fieldline" style="min-width:200px">{{ dados_mae.email }}</span></td>
      </tr>
    </table>
  </div>

  <!-- Dados do respons√°vel -->
  <div class="box">
    <div class="box-title">Dados cadastrais do respons√°vel</div>
    <table class="sheet">
      <tr>
        <td class="w-60"><span class="label">Nome completo:</span> <span class="fieldline" style="min-width:300px">{{ dados_resp.nome|default:"" }}</span></td>
        <td class="w-40"><span class="label">Parentesco:</span> <span class="fieldline" style="min-width:140px">{{ dados_resp.parentesco|default:"" }}</span></td>
      </tr>
      <tr>
        <td><span class="label">CPF:</span> <span class="fieldline" style="min-width:160px">{{ dados_resp.cpf|default:"" }}</span></td>
        <td><span class="label">Identidade:</span> <span class="fieldline" style="min-width:160px">{{ dados_resp.identidade|default:"" }}</span></td>
      </tr>
      <tr>
        <td><span class="label">Fone:</span> <span class="fieldline" style="min-width:200px">{{ dados_resp.telefone|default:"" }}</span></td>
        <td><span class="label">E-mail:</span> <span class="fieldline" style="min-width:200px">{{ dados_resp.email|default:"" }}</span></td>
      </tr>
    </table>
    <div style="font-size:10pt; margin-top:4px; color:#444;">
      * Caso o respons√°vel seja pai ou m√£e, os dados acima podem permanecer em branco.
    </div>
  </div>

  <!-- Situa√ß√£o/Op√ß√µes -->
  <div class="box">
    <div class="box-title">Situa√ß√£o/Op√ß√µes</div>
    <div style="display:flex; flex-wrap:wrap; gap:10px 24px;">

      <!-- Situa√ß√£o -->
      <div class="opt">(<span class="cb">{% if aluno.situacao_matricula == 'transferencia' or aluno.forma_acesso == 'transferencia' %}X{% endif %}</span>) Transfer√™ncia</div>
      <div class="opt">(<span class="cb">{% if aluno.situacao_matricula == 'matricula' or aluno.forma_acesso == 'matricula' or not aluno.forma_acesso %}X{% endif %}</span>) Matr√≠cula</div>
      <div class="opt">(<span class="cb">{% if aluno.situacao_matricula == 'rematricula' or aluno.forma_acesso == 'rematricula' %}X{% endif %}</span>) Rematr√≠cula</div>

      <!-- N√≠vel/Modalidade -->
      <div class="opt">N√≠vel/Modalidade de ensino:
        <span class="fieldline" style="min-width:200px">Fundamental</span>
      </div>

      <!-- S√©rie/Ano e Turno -->
      <div class="opt">S√©rie/Ano:
        <span class="fieldline" style="min-width:120px">{{ aluno.serie_ano|default_if_none:"" }}</span>
      </div>
      <div class="opt">Turno:
        <span class="fieldline" style="min-width:90px">{{ aluno.turno_aluno|default_if_none:"" }}</span>
      </div>

      <!-- Data de ingresso -->
      <div class="opt">Data de ingresso:
        <span class="fieldline" style="min-width:120px">{{ aluno.data_ingresso|date:"d/m/Y"|default_if_none:"" }}</span>
      </div>

      <!-- Bolsa fam√≠lia -->
      <div class="opt">Recebe Bolsa Fam√≠lia?
        <span class="opt">Sim (<span class="cb">{% if aluno.bolsa_familia %}X{% endif %}</span>)</span>
        <span class="opt">N√£o (<span class="cb">{% if aluno.bolsa_familia is not None and not aluno.bolsa_familia %}X{% endif %}</span>)</span>
      </div>

      <!-- Transporte escolar -->
      <div class="opt">Transporte escolar:
        <span class="opt">Sim (<span class="cb">{% if transporte and transporte.usa_transporte_escolar %}X{% endif %}</span>)</span>
        <span class="opt">N√£o (<span class="cb">{% if transporte and not transporte.usa_transporte_escolar %}X{% endif %}</span>)</span>
      </div>

      <!-- Dispensa Ensino Religioso -->
      <div class="opt">Dispensa de Ensino Religioso:
        <span class="opt">Sim (<span class="cb">{% if aluno.dispensa_ensino_religioso %}X{% endif %}</span>)</span>
        <span class="opt">N√£o (<span class="cb">{% if not aluno.dispensa_ensino_religioso %}X{% endif %}</span>)</span>
      </div>

      <!-- Necessidades Especiais (flag) -->
      <div class="opt">Portador de Necessidades Especiais:
        <span class="opt">Sim (<span class="cb">{% if saude and saude.possui_necessidade_especial %}X{% endif %}</span>)</span>
        <span class="opt">N√£o (<span class="cb">{% if saude and not saude.possui_necessidade_especial %}X{% endif %}</span>)</span>
      </div>

      <!-- Descri√ß√£o de Necessidades Especiais -->
      <div class="opt" style="white-space:normal;">
        Descri√ß√£o de Necessidades Especiais:
        <span class="fieldline" style="min-width:460px">{% if saude %}{{ saude.descricao_necessidade|default:"" }}{% endif %}</span>
      </div>
    </div>
  </div>

  <!-- Informa√ß√µes complementares -->
  <div class="box">
    <div class="box-title">Informa√ß√µes complementares</div>
    <table class="sheet">
      <tr>
        <td class="w-60">
          Usa medica√ß√£o?
          <span class="opt">Sim (<span class="cb">{% if saude and saude.usa_medicacao %}X{% endif %}</span>)</span>
          <span class="opt">N√£o (<span class="cb">{% if saude and not saude.usa_medicacao %}X{% endif %}</span>)</span>
        </td>
        <td class="w-40">Quais? <span class="fieldline" style="min-width:220px">{% if saude %}{{ saude.quais_medicacoes|default:"" }}{% endif %}</span></td>
      </tr>
      <tr>
        <td>
          Possui alergia?
          <span class="opt">Sim (<span class="cb">{% if saude and saude.possui_alergia %}X{% endif %}</span>)</span>
          <span class="opt">N√£o (<span class="cb">{% if saude and not saude.possui_alergia %}X{% endif %}</span>)</span>
        </td>
        <td>Qual? <span class="fieldline" style="min-width:220px">{% if saude %}{{ saude.descricao_alergia|default:"" }}{% endif %}</span></td>
      </tr>
      <tr>
        <td>
          Usa transporte escolar?
          <span class="opt">Sim (<span class="cb">{% if transporte and transporte.usa_transporte_escolar %}X{% endif %}</span>)</span>
          <span class="opt">N√£o (<span class="cb">{% if transporte and not transporte.usa_transporte_escolar %}X{% endif %}</span>)</span>
        </td>
        <td>Trajeto/Ponto: <span class="fieldline" style="min-width:220px">{% if transporte %}{{ transporte.trajeto|default:"" }}{% endif %}</span></td>
      </tr>

      <!-- Restri√ß√µes alimentares -->
      <tr>
        <td colspan="2">
          Restri√ß√µes alimentares:
          <span class="fieldline" style="min-width:460px">{% if saude %}{{ saude.restricoes_alimentares|default:"" }}{% endif %}</span>
        </td>
      </tr>

      <tr>
        <td>
          Autoriza√ß√£o para sair sozinho:
          <span class="opt">Sim (<span class="cb">{% if autoriz and autoriz.autorizacao_saida_sozinho %}X{% endif %}</span>)</span>
          <span class="opt">N√£o (<span class="cb">{% if autoriz and not autoriz.autorizacao_saida_sozinho %}X{% endif %}</span>)</span>
        </td>
        <td>Pessoa autorizada a buscar: <span class="fieldline" style="min-width:220px">{% if autoriz %}{{ autoriz.pessoa_autorizada_buscar|default:"" }}{% endif %}</span></td>
      </tr>
    </table>
  </div>

  <!-- Local e data -->
  <div style="margin-top: 16px;">
    {% if aluno.escola %}
      {{ aluno.escola.cidade|default:"Camocim de S√£o F√©lix" }} ‚Äî {{ aluno.escola.estado|default:"PE" }},
    {% else %}
      Camocim de S√£o F√©lix ‚Äî PE,
    {% endif %}
    {{ hoje_extenso|title }}
  </div>

  <!-- Assinaturas -->
  <div class="signrow">
    <div class="sign">
      <div class="line"></div>
      Assinatura do Pai ou Respons√°vel
    </div>
    <div class="sign">
      <div class="line"></div>
      Diretor(a)
    </div>
  </div>
</body>
</html>
